@model IEnumerable<SoftPets.Models.Vacuna>
@{
    ViewBag.Title = "Catálogo de Vacunas y Pastillas";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string tipo = ViewBag.Tipo as string ?? "";
    string estado = ViewBag.Estado as string ?? "";
}

<div class="main-content-bg">
    <div class="tabla-container">
        <h2 class="text-center mb-4">Catálogo de Vacunas y Pastillas</h2>
        <form id="filtroForm" class="row mb-3 g-2 justify-content-center">
            <div class="col-auto">
                <select name="tipo" class="form-select">
                    <option value="">-- Tipo --</option>
                    <option value="Vacuna" @(tipo == "Vacuna" ? "selected" : "")>Vacuna</option>
                    <option value="Pastilla" @(tipo == "Pastilla" ? "selected" : "")>Pastilla</option>
                </select>
            </div>
            <div class="col-auto">
                <select name="estado" class="form-select">
                    <option value="">-- Estado --</option>
                    <option value="Activo" @(estado == "Activo" ? "selected" : "")>Activo</option>
                    <option value="Inactivo" @(estado == "Inactivo" ? "selected" : "")>Inactivo</option>
                </select>
            </div>
            <div class="col-auto align-self-end">
                @Html.ActionLink("Registrar Vacuna/Pastilla", "Create", null, new { @class = "btn btn-unificado btn-crear-nuevo mb-3" })
            </div>
        </form>
        @Html.Partial("_TablaVacunas", Model)
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
function cargarTablaVacunas() {
    var data = $("#filtroForm").serialize();
    $.get('@Url.Action("FiltrarAjax", "Vacunas")', data, function (html) {
        $("#tablaVacunas").replaceWith($(html).find("#tablaVacunas"));
    });
}
$('#filtroForm select').on('change', function () {
    cargarTablaVacunas();
});
    </script>
}
